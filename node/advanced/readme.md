# node.js 基本架构

# node.js 是什么

是一个运行在操作系统上的 javascript 运行时环境， 提供了一系列操作系统的 api。

# 文章生成工具

- 输入标题
- 读取语料库
- 判断字数达标？
- 是 -- 生成文章
- 否 -- 继续在语料库中选取内容 -- 直到字数达标 -- 生成文章

# HTTP

- 标准的开发式互联网模型

1. 物理层
2. 数据链路层
3. 网络层：IP协议 DNS解析
4. 传输层：TCP协议
5. 会话层
6. 表示层
7. 应用层：HTTP协议

- 使用net模块创建TCP服务，用TCP服务来处理客户端的HTTP请求，粗腰使用字符串模板来组织HTTP请求和响应报文，比较麻烦

- 使用HTTP模块船舰HTTP服务，更简便处理HTTP请求。

## 为什么HTTP协议要分请求头和请求体

为了内容协商：根据不同的accept请求头，返回不同的内容。

## 静态文件服务

# HTTP 缓存

- 强缓存
  在响应头中添加 'Cache-Control': 'max-age=86400'
    1. 浏览器会缓存文件，在缓存时间内，再次请求该文件，浏览器会直接从缓存中读取文件，不会向服务器请求文件。
    2. 缓存时间可以通过 Cache-Control 头来设置，单位是秒。

    3. 通过浏览器地址栏请求的资源是无法被强缓存的


- 协商缓存

  服务端返回一个资源并设置 'last-modified': stat.mtimeMs， 那么浏览器下一次请求该资源时，会自动在请求头中添加 '
  if-modified-since': 'last-modified' 的值，服务端会根据这个值来判断是否返回资源。

    1. 让浏览器 url 地址栏请求的资源也可以走缓存

    - 'last-modified': stat.mtimeMs 存在一个缺陷，就是如果资源改变又撤销改变，浏览器就因为资源最后一次修改时间对不上而重新获取资源

    - 'etag': "文件指纹"： 每次资源改变，文件指纹就会改变，浏览器会根据文件指纹来判断是否返回资源。

# 文件名修改

- 服务端的图片都命名为 logo.xxxxxx.png 其中 xxxxxx 是文件的哈希值
