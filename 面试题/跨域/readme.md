# 跨域

跨域（Cross-Origin）是指浏览器出于安全原因，限制了一个源（协议、域名、端口）的网页请求另一个源的资源。

# 同源策略

- https://&ensp;&ensp;&ensp;&ensp;192.168.xx.xx&ensp;&ensp;&ensp;&ensp;:XXXX&ensp;&ensp;&ensp;&ensp;/home
  <br>
  协议&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;域名/IP地址&ensp;&ensp;&ensp;&ensp;&ensp;端口号&ensp;&ensp;&ensp;&ensp;路径
  <br>
  <br>
- 为保证服务器端的安全，浏览器自带同源策略：
    - 协议、域名/IP地址、端口号三者必须完全相同的两个源，才能认为是同源，可以相互访问
    - **同源策略破坏的是响应数据，但不破坏请求数据**
    - 不约束`<script>`, `<img>`, `<link>`等标签发起的请求，浏览器**url直接发送请求**也不受同源策略限制

- 在开发过程中规避同源策略

1. 前端使用`JSONP`技术，绕过同源策略限制

   > 由于`<script>`标签不受同源策略限制，前端动态生成`<script>`标签并设置`src`目标地址和提前定义好回调函数，将名称作为参数传递给后端
   >
   > 后端将该参数处理成函数调用的形式并传入要返回的数据，最后返回给前端
   >
   > 接收到后端返回后，前端会自动调用回调函数来获取响应数据

    - 缺点
        1. 只支持`GET`请求
        2. 必须要后端支持

2. 前端使用`CORS`技术，允许跨域请求

   > 后端在响应头中配置允许的源、方法、头信息，来告知浏览器不需要同源策略的保护

3. `nginx`反向代理

   由于`nginx`作为服务器，不受同源策略限制，在不方便操作下游服务器时，可以使用`nginx`作为中间代理服务器

   > 利用nginx的反向代理功能，将请求转发到后端服务器
   >
   > 后端服务器收到请求后，将相应返回给nginx，nginx再将响应返回给前端浏览器

4. WebSocket

   > WebSocket协议，浏览器和服务器实现全双工通信，不受同源策略限制，可以实现跨域通信
   >
   > 适用于需要频繁双向通信的场景，如实时聊天、在线游戏、协同文档等
   
5. postMessage

   > 通过`postMessage`方法，可以实现不同源之间的通信
   >
   > 适用于嵌入式页面（如`iframe`）之间的通信